<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Brave Soles VR Showroom</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <!-- FADE OVERLAY FOR TELEPORT -->
    <div id="fadeOverlay" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: black; opacity: 0; pointer-events: none; z-index: 998; transition: opacity 0.5s;"></div>
    <!-- INTRO CANVAS -->
    <div id="introCanvas" style="position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.85); display: flex; align-items: center; justify-content: center; flex-direction: column; color: white; font-family: sans-serif; z-index: 999;">
      <h1 style="margin-bottom: 20px;">Welcome to Brave Soles VR</h1>
      <button onclick="startExperience()" style="padding: 15px 30px; font-size: 18px; cursor: pointer;">Enter VR Experience</button>
    </div>

    <a-scene sound>
      <a-assets>
        <a-asset-item id="sandalModel" src="assets/sandal_shoes.glb"></a-asset-item>
        <img id="woodFloor" src="assets/wood_floor.jpg">
        <img id="logo" src="assets/bravesoles_logo.png">
        <img id="mossWall" src="assets/photo-wall-texture-pattern.jpg">
        <audio id="brandAudio" src="assets/brandstory.mp3" preload="auto" playsinline></audio>
        <audio id="ambientAudio" src="assets/calm_ambient.mp3" preload="auto" playsinline></audio>
        <img id="lindaTop" src="assets/Linda_Top_View.jpg">
        <img id="avarcaImg" src="assets/Avarca_ToriWatson_BraveSoles_0003.jpg">
        <img id="img0771" src="assets/IMG_0771.jpg">
        <img id="jasmineCaramel" src="assets/Jasmine Caramel.jpg">
        <img id="jasmineWhite" src="assets/Jasmine_Wht_Ca_LS2_Web.jpg">
        <img id="padreFlipflop" src="assets/Padre_Caramel_Leather_Front.jpg">
        <audio id="clickSound" src="assets/click.mp3" preload="auto"></audio>
      </a-assets>
   
      
        <!-- Linda World -->
        <a-entity id="lindaWorld" visible="false">
          <!-- Lighting -->
          <a-light type="ambient" color="#ffffff" intensity="1.0"></a-light>
          <a-light type="directional" color="#ffffff" intensity="0.4" position="2 4 1"></a-light>

          <!-- Ground -->
          <a-plane position="0 0 -1" rotation="-90 0 0" width="10" height="10" color="#bdf3e2"></a-plane>

          <!-- Welcome Text -->
          <a-text value="Return to Main Room" position="0 2.5 -3" align="center" color="#000" width="6"></a-text>

          <!-- Return Door -->
          <a-entity id="returnDoor" position="0 1 -4">
            <a-box width="1" height="2" depth="0.1" color="#6b4f30" opacity="0.95" class="clickable" teleport-back-to-showroom></a-box>
            <a-text value="Return to Main Room" align="center" position="0 1.4 0.1" color="#000" width="4"></a-text>
          </a-entity>
        </a-entity>


   
      

      <!-- Showroom -->
      <a-entity id="showroom" visible="true">
     <!-- Linda World Entry Trigger -->
     <a-entity id="lindaPortal" position="3 3.0 -4.01">
      <a-plane width="2.8" height="0.8" color="#ffffff"  opacity="0.95"
               position="0 0 0.01"
               class="clickable"
               enter-linda-world
               animation="property: material.color; dir: alternate; dur: 1500; loop: true; to: #eeeeee">
      </a-plane>
      <a-text value="Enter the Linda World"
              align="center"
              color="#000000" 
              width="4"
              position="0 0 0.02"
              animation="property: position; dir: alternate; dur: 1500; easing: easeInOutSine; loop: true; to: 0 0.1 0.02">
      </a-text>
    </a-entity>
    
          <!-- CAMERA + PANELS -->
          <!-- CAMERA RIG THAT WORKS IN BOTH VR AND NON-VR -->
          <a-entity id="rig">
            <a-camera 
              id="mainCamera" 
              position="0 1.6 4.5" 
              look-controls 
              wasd-controls="enabled: false">
              
              <!-- Gaze cursor for VR -->
              <a-cursor id="vrCursor"
                visible="false"
                fuse="true" 
                fuse-timeout="1000" 
                raycaster="objects: .clickable" 
                material="color: black; shader: flat"
                animation__click="property: scale; startEvents: click; from: 1 1 1; to: 1.3 1.3 1.3; dur: 150; dir: alternate"
                sound="on: click; src: #clickSound">
              </a-cursor>
                   <!-- LINDA PANEL -->
              <a-entity id="lindaPanel" visible="false" position="0 0 -3">
                <a-plane color="#3a2f23" width="1.8" height="1.2" opacity="0.95"></a-plane>
                <a-text value="The Linda Leather Slide Sandal.\n\n'Simple. Elegant. Beautiful.'" color="#fff" position="0 0.3 0.01" align="center" width="2.4" wrap-count="40"></a-text>
                <a-plane id="closeLindaBtn" position="0 -0.3 0.02" width="0.5" height="0.2" color="#AA3333" class="clickable" close-linda></a-plane>
                <a-text value="Close" position="0 -0.3 0.03" align="center" color="#fff" width="1"></a-text>
              </a-entity>

              <!-- PADRE PANEL -->
              <a-entity id="padrePanel" visible="false" position="0 0 -3">
                <a-plane color="#3a2f23" width="1.8" height="1.3" opacity="0.95"></a-plane>
                <a-text value="The Padre Men's Leather Flip Flop\n\n'Strong. Comfortable. Adventurous.'" color="#fff" position="0 0.4 0.01" align="center" width="2.4" wrap-count="40"></a-text>
                <a-plane id="closePadreBtn" position="0 -0.3 0.02" width="0.5" height="0.2" color="#AA3333" class="clickable" close-padre></a-plane>
                <a-text value="Close" position="0 -0.3 0.03" align="center" color="#fff" width="1"></a-text>
              </a-entity>
            </a-camera>
          </a-entity>

        <!-- VR Controller Raycasters -->
     
          <a-entity laser-controls="hand: left" raycaster="objects: .clickable" line="color: #64c36e" sound="on: triggerdown; src: #clickSound"></a-entity>
          <a-entity laser-controls="hand: right" raycaster="objects: .clickable" line="color: #64c36e" sound="on: triggerdown; src: #clickSound"></a-entity>
          <a-entity id="mouseRaycaster" 
            raycaster="objects: .clickable" 
            cursor="rayOrigin: mouse"
            visible="false"
            sound="on: click; src: #clickSound">
          </a-entity>





   

      

        <!-- ENVIRONMENT -->
        <a-light type="ambient" color="#fff5e1" intensity="0.6"></a-light>
        <a-light type="directional" color="#ffddb3" intensity="0.4" position="2 4 1"></a-light>
        <a-sky id="sky" color="#ffedd5"></a-sky>
        <a-plane rotation="-90 0 0" width="10" height="10" src="#woodFloor" repeat="4 4" material="roughness: 0.7; metalness: 0.1"></a-plane>
        <a-plane position="-5 2.5 0" rotation="0 90 0" width="10" height="5" src="#mossWall"></a-plane>
        <a-plane position="5 2.5 0" rotation="0 -90 0" width="10" height="5" src="#mossWall"></a-plane>
        <a-plane position="0 2.5 5" rotation="0 180 0" width="10" height="5" src="#mossWall"></a-plane>
        <a-plane position="0 2.5 -4.01" rotation="0 0 0" width="10" height="5" src="#woodFloor" material="repeat: 2 2"></a-plane>


        <!-- Left Wall Images -->
        <a-image src="#avarcaImg" position="-4.99 2.5 -1.2" rotation="0 90 0" width="2" height="1.2"></a-image>
        <a-image src="#img0771"  position="-4.99 2.5 2.5" rotation="0 90 0" width="2" height="1.2"></a-image>
        

        <!-- Right Wall Images -->
        <a-image src="#jasmineCaramel" position="4.99 2.8 2.5" rotation="0 -90 0" width="2" height="1.2"></a-image>
        <a-image src="#jasmineWhite"   position="4.99 2.8 -1.2" rotation="0 -90 0" width="2" height="1.2"></a-image>
        


        <!-- LOGO -->
        <a-entity position="0 0 -4.01">
          <a-image src="#logo" position="0 4 0.01" rotation="0 0 0" width="2.5" height="1.2" show-brand-info></a-image>
        </a-entity>
        
                <!-- PADRE PRODUCT IMAGE + TELEPORT -->
              <a-entity position="-2.7 0 -4.01">
                  <a-image src="#padreFlipflop" position="0 1.5 0.01" width="2.25" height="1.2" class="clickable" show-padre></a-image>
                </a-entity>
              <a-circle 
                position="-2 0.01 -2.3" 
                rotation="-90 0 0" 
                radius="0.3" 
                color="#64c36e" 
                opacity="0.6" 
                class="clickable"
                teleport-to-padre event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6"></a-circle>
                
            

      
              <!-- LINDA PRODUCT IMAGE + TELEPORT -->
              <a-entity position="2.7 0 -4.01">
                <a-image src="#lindaTop" position="0 1.5 0.01" width="2.25" height="1.2" class="clickable" show-linda></a-image>
              </a-entity>
              <a-circle position="2 0.01 -3" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6"
                        class="clickable" teleport-to-linda 
                        event-set__enter="_event: mouseenter; material.opacity: 1"
                        event-set__leave="_event: mouseleave; material.opacity: 0.6"></a-circle>
                        
          
      
              <!-- ADDITIONAL TELEPORT SPOTS -->
              <a-circle position="0 0.01 0" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-to-center event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6"></a-circle>
              
              <a-circle position="0.5 0.01 -2.5" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-to-sandal event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6"></a-circle>
              
              <a-circle position="0 0.01 3.5" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-front event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6">
                </a-circle>
              <a-circle position="-3.5 0.01 0" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-left event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6">
                </a-circle>
              <a-circle position="3.5 0.01 0" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-right event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6">
                </a-circle>
             
              <a-circle position="-3.5 0.01 3.5" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-front-left event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6">
                </a-circle>


              <a-circle position="3.5 0.01 3.5" rotation="-90 0 0" radius="0.3" color="#64c36e" opacity="0.6" class="clickable" teleport-front-right 
                event-set__enter="_event: mouseenter; material.opacity: 1"
                event-set__leave="_event: mouseleave; material.opacity: 0.6"></a-circle>


             <!-- Brand Story Panel - White Background with Thick Black Border -->
              <a-entity position="0 3 4.99" rotation="0 180 0">
                <!-- Black Border -->
                <a-plane 
                  width="4.7" 
                  height="3.0" 
                  color="#000000" 
                  position="0 0 0">
                </a-plane>

                <!-- White Inner Panel -->
                <a-plane 
                  width="4.5" 
                  height="2.8" 
                  color="#ffffff" 
                  opacity="0.97"
                  position="0 0 0.01">
                </a-plane>

                <!-- Text Content -->
                <a-text 
                  value="Founded in 2017 by Christal Earle, Brave Soles crafts classically styled footwear and accessories using upcycled tires and ethically sourced materials. Handmade by skilled artisans through small-scale, transparent production chains, every piece reflects the brandâ€™s deep commitment to sustainability and social impact. Brave Soles represents sustainable fashion with soul."
                  color="#000000" 
                  width="4" 
                  position="0 0 0.02" 
                  align="center" 
                  wrap-count="60"
                  font="mozillavr">
                </a-text>
              </a-entity>

      
            </a-entity> <!-- End showroom -->
      
          </a-scene>
      
          <script>
            function startExperience() {
              const canvas = document.getElementById('introCanvas');
              canvas.style.transition = 'opacity 1s';
              canvas.style.opacity = '0';
              setTimeout(() => canvas.style.display = 'none', 1000);
              const camera = document.querySelector('#mainCamera');
              camera.setAttribute('sound', 'src: #brandAudio; autoplay: true');
              camera.addEventListener('sound-ended', () => {
                camera.setAttribute('sound', 'src: #ambientAudio; autoplay: true; loop: true; volume: 0.4');
              });
            }
      
            function teleportWithFade(x, y, z) {
              const overlay = document.getElementById('fadeOverlay');
              overlay.style.opacity = 1;
              setTimeout(() => {
                document.querySelector('#mainCamera').setAttribute('position', { x, y, z });
                overlay.style.opacity = 0;
              }, 400);
            }

            function addTeleportEvents(el, x, y, z) {
              const teleport = () => {
                teleportWithFade(x, y, z);
                document.querySelector('#clickSound').play();
              };
              el.addEventListener('click', teleport);
              el.addEventListener('triggerdown', teleport);
            }
      
            function teleportWithFadeAndSwitch(worldId) {
              const overlay = document.getElementById('fadeOverlay');
              overlay.style.opacity = 1;
              setTimeout(() => {
                document.querySelectorAll('a-entity[id$="World"]').forEach(el => el.setAttribute('visible', false));
                document.querySelector('#showroom').setAttribute('visible', worldId === 'showroom');
                document.querySelector(`#${worldId}`).setAttribute('visible', true);
                document.querySelector('#mainCamera').setAttribute('position', { x: 0, y: 1.6, z: 0 });
                overlay.style.opacity = 0;
              }, 400);
            }
      
            function hideAllPanels() {
              ['lindaPanel', 'padrePanel'].forEach(id => {
                const panel = document.querySelector(`#${id}`);
                if (panel) panel.setAttribute('visible', false);
              });
            }
      
            AFRAME.registerComponent('enter-linda-world', {
              init: function () {
                this.el.addEventListener('click', () => {
                  teleportWithFadeAndSwitch('lindaWorld');
                });
              }
            });
      
            AFRAME.registerComponent('teleport-back-to-showroom', {
              init: function () {
                this.el.addEventListener('click', () => {
                  teleportWithFadeAndSwitch('showroom');
                });
              }
            });
      
            AFRAME.registerComponent('show-linda', {
              init: function () {
                this.el.addEventListener('click', () => {
                  hideAllPanels();
                  document.querySelector('#lindaPanel').setAttribute('visible', true);
                });
              }
            });
      
            AFRAME.registerComponent('close-linda', {
              init: function () {
                this.el.addEventListener('click', () => {
                  document.querySelector('#lindaPanel').setAttribute('visible', false);
                });
              }
            });
      
            AFRAME.registerComponent('show-padre', {
              init: function () {
                this.el.addEventListener('click', () => {
                  hideAllPanels();
                  document.querySelector('#padrePanel').setAttribute('visible', true);
                });
              }
            });
      
            AFRAME.registerComponent('close-padre', {
              init: function () {
                this.el.addEventListener('click', () => {
                  console.log("Padre close clicked"); // This should appear in console
                  document.querySelector('#padrePanel').setAttribute('visible', false);
                });
              }
            });
      
           AFRAME.registerComponent('teleport-to-linda', {
            init: function () {
              addTeleportEvents(this.el, 2, 1.6, -2);
            }
          });

          AFRAME.registerComponent('teleport-to-sandal', {
            init: function () {
              addTeleportEvents(this.el, 0.5, 1.6, -2.5);
            }
          });

          AFRAME.registerComponent('teleport-to-padre', {
            init: function () {
              addTeleportEvents(this.el, -2, 1.6, -2.3);
            }
          });

          AFRAME.registerComponent('teleport-to-center', {
            init: function () {
              addTeleportEvents(this.el, 0, 1.6, 0);
            }
          });

          AFRAME.registerComponent('teleport-front', {
            init: function () {
              addTeleportEvents(this.el, 0, 1.6, 3.5);
            }
          });

          AFRAME.registerComponent('teleport-left', {
            init: function () {
              addTeleportEvents(this.el, -3.5, 1.6, 0);
            }
          });

          AFRAME.registerComponent('teleport-right', {
            init: function () {
              addTeleportEvents(this.el, 3.5, 1.6, 0);
            }
          });

          AFRAME.registerComponent('teleport-front-left', {
            init: function () {
              addTeleportEvents(this.el, -3.5, 1.6, 3.5);
            }
          });

          AFRAME.registerComponent('teleport-front-right', {
            init: function () {
              addTeleportEvents(this.el, 3.5, 1.6, 3.5);
            }
          });
            AFRAME.scenes[0].addEventListener('enter-vr', () => {
            const cursor = document.querySelector('#vrCursor');

            // Give a bit of time for controllers to initialize
            setTimeout(() => {
              const controllers = document.querySelectorAll('[laser-controls]');
              const hasControllers = Array.from(controllers).some(controller => controller.components && controller.components['tracked-controls']?.controllerPresent);

              // Show reticle only if no controllers are connected
              cursor.setAttribute('visible', !hasControllers);
            }, 500);
          });

          AFRAME.scenes[0].addEventListener('exit-vr', () => {
            document.querySelector('#vrCursor').setAttribute('visible', false);
          });



    </script>
 </body>
</html>
      

